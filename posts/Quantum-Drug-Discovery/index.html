<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Quantum Drug Discovery" /><meta property="og:locale" content="en" /><meta name="description" content="Drug Discovery: Protein Folding on IBM’s Qiskit Quantum Information Framework : NVIDIA A100 exascale.mahidol.ac.th" /><meta property="og:description" content="Drug Discovery: Protein Folding on IBM’s Qiskit Quantum Information Framework : NVIDIA A100 exascale.mahidol.ac.th" /><link rel="canonical" href="https://snitgit.github.io/posts/Quantum-Drug-Discovery/" /><meta property="og:url" content="https://snitgit.github.io/posts/Quantum-Drug-Discovery/" /><meta property="og:site_name" content="Extreme Tools for Science and Engineering Discovery" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-11-17T00:00:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Quantum Drug Discovery" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-11-17T08:21:25+07:00","datePublished":"2022-11-17T00:00:00+07:00","description":"Drug Discovery: Protein Folding on IBM’s Qiskit Quantum Information Framework : NVIDIA A100 exascale.mahidol.ac.th","headline":"Quantum Drug Discovery","mainEntityOfPage":{"@type":"WebPage","@id":"https://snitgit.github.io/posts/Quantum-Drug-Discovery/"},"url":"https://snitgit.github.io/posts/Quantum-Drug-Discovery/"}</script><title>Quantum Drug Discovery | Extreme Tools for Science and Engineering Discovery</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Extreme Tools for Science and Engineering Discovery"><meta name="application-name" content="Extreme Tools for Science and Engineering Discovery"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">Extreme Tools for Science and Engineering Discovery</a></div><div class="site-subtitle font-italic">Welcome Faculty Visit</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/snitgit" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['snit.san','mahidol...'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Quantum Drug Discovery</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Quantum Drug Discovery</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1668618000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Nov 17, 2022 </em> </span> <span> Updated <em class="" data-ts="1668648085" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Nov 17, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">SNIT SANGHLAO</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3096 words"> <em>17 min</em> read</span></div></div></div><div class="post-content"><h1 id="drug-discovery-protein-folding-on-ibms-qiskit-quantum-information-framework--nvidia-a100-exascalemahidolacth">Drug Discovery: Protein Folding on IBM’s Qiskit Quantum Information Framework : NVIDIA A100 exascale.mahidol.ac.th</h1><p>Before Covid-19 there is shown of obstacles for Quantum Supremacy[7]. December 2021, simulating the sycamore quantum supremacy circuit hooked our future “optimazation algorithms” imagination[8]. After than we have worked cuQuantum but there is not progress after a year. Until we get one motivation that we can try quantum information on GPU[9]. Finally, end up with IBM’s Qiskit framework for two reasons that very youtube video and tutorial[10]. The second that Qiskit drawn our attention is “Protien folding”[11]. Having been tried on QAOA on GPUs, we are VQE is promissing.</p><p>The follo detail actually 99.9999% from the source [11] with migration to run on GPUs and cuQuantum.</p><h3 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The structure and function of many natural and human-engineered proteins is still only poorly understood. As a result, our understanding of processes connected with protein folding, such as those encountered in Alzheimer’s disease, vaccine development, and crop improvement research, has remained limited.</p><p>Unfolded polypeptides have a very large number of degrees of freedom and thus an enormous number of potential conformations. For example, a chain with $100$ aminoacids has on the order of $10^{47}$ conformations. In reality, however, many proteins fold to their native structure within seconds. This is known as Levinthal’s paradox [1].</p><p>The exponential growth of potential conformations with chain length makes the problem intractable for classical computers. In the quantum framework, our resource-efficient algorithm scales linearly with the number of aminoacids N.</p><p>The goal of this work is to determine the minimum energy conformation of a protein. Starting from a random configuration, the protein’s structure is optimized to lower the energy. This can be achieved by encoding the protein folding problem into a qubit operator and ensuring that all physical constraints are satisfied.</p><p>For the problem encoding we use:</p><ul><li><p>Configuration qubits: qubits that are used to describe the configurations and the relative position of the different beads</p><li><p>Interaction qubits: qubits that encode interactions between the different aminoacids</p></ul><p>For our case we use a tetrahedral lattice (diamond shape lattice) where we encode the movement through the configuration qubits (see image below).</p><p><img data-src="https://raw.githubusercontent.com/qiskit-research/qiskit-research/183e18e24aab2580922625a91b93df4eb8778e9c/docs/protein_folding/aux_files/lattice_protein.png" width="300" data-proofer-ignore></p><p>The Hamiltonian of the system for a set of qubits $\mathbf{q}={\mathbf{q}<em>{cf}, \mathbf{q}</em>{in}}$ is</p>\[H(\mathbf{q}) = H_{gc}(\mathbf{q}_{cf}) + H_{ch}(\mathbf{q}_{cf}) + H_{in}(\mathbf{q}_{cf}, \mathbf{q}_{in})\]<p>where</p><ul><li><p>$H_{gc}$ is the geometrical constraint term (governing the growth of the primary sequence of aminoacids without bifurcations)</p><li><p>$H_{ch}$ is the chirality constraint (enforcing the right stereochemistry for the system)</p><li><p>$H_{in}$ is the interaction energy terms of the system. In our case we consider only nearest neighbor interactions.</p></ul><p>Further details about the used model and the encoding of the problem can be found in [2].</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="err">!</span> <span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">qiskit</span><span class="o">-</span><span class="n">research</span><span class="o">/</span><span class="n">qiskit</span><span class="o">-</span><span class="n">research</span><span class="p">.</span><span class="n">git</span>
<span class="err">!</span> <span class="n">cd</span> <span class="n">qiskit</span><span class="o">-</span><span class="n">research</span> <span class="o">&amp;&amp;</span> <span class="n">pip</span> <span class="n">install</span> <span class="p">.</span>


</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">qiskit_research.protein_folding.interactions.random_interaction</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">RandomInteraction</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">qiskit_research.protein_folding.interactions.miyazawa_jernigan_interaction</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">MiyazawaJerniganInteraction</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">qiskit_research.protein_folding.peptide.peptide</span> <span class="kn">import</span> <span class="n">Peptide</span>
<span class="kn">from</span> <span class="nn">qiskit_research.protein_folding.protein_folding_problem</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ProteinFoldingProblem</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">qiskit_research.protein_folding.penalty_parameters</span> <span class="kn">import</span> <span class="n">PenaltyParameters</span>

<span class="kn">from</span> <span class="nn">qiskit.utils</span> <span class="kn">import</span> <span class="n">algorithm_globals</span><span class="p">,</span> <span class="n">QuantumInstance</span>

<span class="n">algorithm_globals</span><span class="p">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="mi">23</span>
</pre></table></code></div></div><h3 id="protein-main-chain"><span class="mr-2">Protein Main Chain</span><a href="#protein-main-chain" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The Protein consists of a main chain that is a linear chain of aminoacids. For the naming of different residues we use the one-letter code as defined in Ref. [3]. Further details about the naming and the type of aminoacids can also be found in [4].</p><p>For this particular case we demonstrate the generation of the qubit operator in a neuropeptide with the main chain consisting of 7 aminoacids with letter codes APRLRFY (see also [2]).</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">main_chain</span> <span class="o">=</span> <span class="s">"APRLRFY"</span>
</pre></table></code></div></div><h3 id="side-chains"><span class="mr-2">Side Chains</span><a href="#side-chains" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Beyond the main chain of the protein there may be aminoacids attached to the residues of the main chain. Our model allows for side chains of the maximum length of one. Elongated side chains would require the introduction of additional penalty terms which are still under development. In this example we do not consider any side chains to keep the real structure of the neuropeptide.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">side_chains</span> <span class="o">=</span> <span class="p">[</span><span class="s">""</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
</pre></table></code></div></div><h3 id="interaction-between-aminoacids"><span class="mr-2">Interaction between Aminoacids</span><a href="#interaction-between-aminoacids" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>For the description of inter-residue contacts for proteins we use knowledge-based (statistical) potentials derived using quasi-chemical approximation. The potentials used here are introduced by Miyazawa, S. and Jernigan, R. L. in [5].</p><p>Beyond this model we also allow for random contact maps (interactions) that provide a random interaction map. One can also introduce a custom interaction map that enhances certain configurations of the protein (e.g. alpha helix, beta sheet etc).</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">random_interaction</span> <span class="o">=</span> <span class="n">RandomInteraction</span><span class="p">()</span>
<span class="n">mj_interaction</span> <span class="o">=</span> <span class="n">MiyazawaJerniganInteraction</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="physical-constraints"><span class="mr-2">Physical Constraints</span><a href="#physical-constraints" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To ensure that all physical constraints are respected we introduce penalty functions. The different penalty terms used are:</p><ul><li><p>penalty_chiral: A penalty parameter used to impose the right chirality.</p><li><p>penalty_back: A penalty parameter used to penalize turns along the same axis. This term is used to eliminate sequences where the same axis is chosen twice in a row. In this way we do not allow for a chain to fold back into itself.</p><li><p>penalty_1: A penalty parameter used to penalize local overlap between beads within a nearest neighbor contact.</p></ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">penalty_back</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">penalty_chiral</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">penalty_1</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">penalty_terms</span> <span class="o">=</span> <span class="n">PenaltyParameters</span><span class="p">(</span><span class="n">penalty_chiral</span><span class="p">,</span> <span class="n">penalty_back</span><span class="p">,</span> <span class="n">penalty_1</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="peptide-definition"><span class="mr-2">Peptide Definition</span><a href="#peptide-definition" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Based on the main chain and possible side chains we define the peptide object that includes all the structural information of the modeled system.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">peptide</span> <span class="o">=</span> <span class="n">Peptide</span><span class="p">(</span><span class="n">main_chain</span><span class="p">,</span> <span class="n">side_chains</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="protein-folding-problem"><span class="mr-2">Protein Folding Problem</span><a href="#protein-folding-problem" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Based on the defined peptide, the interaction (contact map) and the penalty terms we defined for our model we define the protein folding problem that returns qubit operators.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">protein_folding_problem</span> <span class="o">=</span> <span class="n">ProteinFoldingProblem</span><span class="p">(</span><span class="n">peptide</span><span class="p">,</span> <span class="n">mj_interaction</span><span class="p">,</span> <span class="n">penalty_terms</span><span class="p">)</span>
<span class="n">qubit_op</span> <span class="o">=</span> <span class="n">protein_folding_problem</span><span class="p">.</span><span class="n">qubit_op</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="n">qubit_op</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
</pre><td class="rouge-code"><pre>1613.5895000000003 * IIIIIIIII
+ 487.5 * IIIIIIZII
- 192.5 * IIIIIIIZZ
+ 192.5 * IIIIIIZZZ
- 195.0 * IIIIZIZII
- 195.0 * IIIIIZIZI
- 195.0 * IIIIZZZZI
- 95.0 * IIZIZIIII
- 95.0 * IIIZIZIII
- 95.0 * IIZZZZIII
+ 295.0 * IIIIIIZZI
- 497.5 * IIIIZIIII
- 300.0 * IIIIZZIII
+ 195.0 * IIIIIIIIZ
+ 197.5 * IIIIIZIIZ
- 197.5 * IIIIZZIIZ
- 904.2875 * IZIIIIIII
- 295.0 * IZIIIIZII
- 197.5 * IZIIIIZZI
+ 302.5 * IZIIZIIII
+ 202.5 * IZIIZZIII
+ 100.0 * IZIIZIZII
+ 100.0 * IZIIIZIZI
+ 100.0 * IZIIZZZZI
- 200.0 * IZIIIIIIZ
+ 97.5 * IZIIIIIZZ
- 97.5 * IZIIIIZZZ
- 100.0 * IZIIIZIIZ
+ 100.0 * IZIIZZIIZ
+ 100.0 * IIIIIIIZI
- 100.0 * IIIIIZIII
+ 2.5 * IZIIIIIZI
- 2.5 * IZIIIZIII
+ 192.5 * IIZIIIIII
+ 95.0 * IIZZIIIII
+ 97.5 * IIZIIIZII
+ 97.5 * IIIZIIIZI
+ 97.5 * IIZZIIZZI
- 97.5 * IIIZIIIIZ
+ 97.5 * IIZZIIIIZ
+ 7.5 * IZZIIIIII
+ 5.0 * IZZZIIIII
+ 2.5 * IZZIIIZII
+ 2.5 * IZIZIIIZI
+ 2.5 * IZZZIIZZI
- 2.5 * IZZIZIIII
- 2.5 * IZIZIZIII
- 2.5 * IZZZZZIII
- 2.5 * IZIZIIIIZ
+ 2.5 * IZZZIIIIZ
+ 105.0 * IIIZIIIII
- 701.802 * ZIIIIIIII
- 195.0 * ZIIIIIZII
- 102.5 * ZIIIIIIZI
- 97.5 * ZIIIIIZZI
+ 195.0 * ZIIIZIIII
+ 102.5 * ZIIIIZIII
+ 97.5 * ZIIIZZIII
- 200.0 * ZIZIIIIII
- 105.0 * ZIIZIIIII
- 100.0 * ZIZZIIIII
+ 97.5 * ZIIIZIZII
- 100.0 * ZIZIIIZII
+ 97.5 * ZIIIIZIZI
- 100.0 * ZIIZIIIZI
+ 97.5 * ZIIIZZZZI
- 100.0 * ZIZZIIZZI
+ 100.0 * ZIZIZIIII
+ 100.0 * ZIIZIZIII
+ 100.0 * ZIZZZZIII
+ 97.5 * ZIIIIIIZZ
- 97.5 * ZIIIIIZZZ
- 97.5 * ZIIIIZIIZ
+ 97.5 * ZIIIZZIIZ
+ 100.0 * ZIIZIIIIZ
- 100.0 * ZIZZIIIIZ
+ 5.0 * ZIIIIIIIZ
</pre></table></code></div></div><h3 id="using-vqe-with-cvar-expectation-value-for-the-solution-of-the-problem"><span class="mr-2">Using VQE with CVaR expectation value for the solution of the problem</span><a href="#using-vqe-with-cvar-expectation-value-for-the-solution-of-the-problem" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The problem that we are tackling has now implemented all the physical constraints and has a diagonal Hamiltonian. For the particular case we are targeting the single bitstring that gives us the minimum energy (corresponding to the folded structure of the protein). Thus, we can use the Variational Quantum Eigensolver with Conditional Value at Risk (CVaR) expectation values for the solution of the problem and for finding the minimum configuration energy [6] . We follow the same approach as in Ref. [2] but here we use COBYLA for the classical optimization part. One can also use the standard VQE or QAOA algorithm for the solution of the problem, though as discussed in Ref. [2] CVaR is more suitable.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">RealAmplitudes</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms.optimizers</span> <span class="kn">import</span> <span class="n">COBYLA</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms</span> <span class="kn">import</span> <span class="n">NumPyMinimumEigensolver</span><span class="p">,</span> <span class="n">VQE</span>
<span class="kn">from</span> <span class="nn">qiskit.opflow</span> <span class="kn">import</span> <span class="n">PauliExpectation</span><span class="p">,</span> <span class="n">CVaRExpectation</span>
<span class="c1">#from qiskit import execute, Aer
</span><span class="kn">from</span> <span class="nn">qiskit.providers.aer</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">time</span>


<span class="c1"># set classical optimizer
</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">COBYLA</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>


<span class="c1"># set variational ansatz
</span><span class="n">ansatz</span> <span class="o">=</span> <span class="n">RealAmplitudes</span><span class="p">(</span><span class="n">reps</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># set the backend
#backend_name = "aer_simulator"              # CPU configure
#backend_name = "aer_simulator_statevector"    # GPU configure
#backend_name = AerSimulator(method = 'statevector',device = 'GPU', blocking_qubits=20)
#backend_name = AerSimulator(method = 'statevector',device = 'GPU')
</span><span class="n">backend_name</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s">'automatic'</span><span class="p">,</span><span class="n">device</span> <span class="o">=</span> <span class="s">'GPU'</span><span class="p">,</span><span class="n">blocking_qubits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1">#backend_name = AerSimulator(method = 'automatic')
#backend_name = 'qasm_simulator'
</span><span class="n">backend</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span>
<span class="c1">#   Aer.get_backend(backend_name),
</span>    <span class="n">backend_name</span><span class="p">,</span>
    <span class="n">shots</span><span class="o">=</span><span class="mi">8192</span><span class="p">,</span>
    <span class="n">seed_transpiler</span><span class="o">=</span><span class="n">algorithm_globals</span><span class="p">.</span><span class="n">random_seed</span><span class="p">,</span>
    <span class="n">seed_simulator</span><span class="o">=</span><span class="n">algorithm_globals</span><span class="p">.</span><span class="n">random_seed</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">def</span> <span class="nf">store_intermediate_result</span><span class="p">(</span><span class="n">eval_count</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">):</span>
    <span class="n">counts</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">eval_count</span><span class="p">)</span>
    <span class="n">values</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>


<span class="c1"># initialize CVaR_alpha objective with alpha = 0.1
</span><span class="n">cvar_exp</span> <span class="o">=</span> <span class="n">CVaRExpectation</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">PauliExpectation</span><span class="p">())</span>

<span class="c1"># initialize VQE using CVaR
</span><span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span>
    <span class="n">expectation</span><span class="o">=</span><span class="n">cvar_exp</span><span class="p">,</span>
    <span class="c1">#expectation=None,
</span>    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">ansatz</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span>
    <span class="n">quantum_instance</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
    <span class="n">callback</span><span class="o">=</span><span class="n">store_intermediate_result</span><span class="p">,</span>
    <span class="c1">#include_custom=True,               # for statevector simulatio, set True, if expectation = None
</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">process_time</span><span class="p">()</span>
<span class="n">raw_result</span> <span class="o">=</span> <span class="n">vqe</span><span class="p">.</span><span class="n">compute_minimum_eigenvalue</span><span class="p">(</span><span class="n">qubit_op</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">process_time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">raw_result</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
</pre><td class="rouge-code"><pre>/home/snit.san/miniconda3/envs/Qiskit/lib/python3.10/site-packages/qiskit/algorithms/minimum_eigen_solvers/vqe.py:625: RuntimeWarning: invalid value encountered in sqrt
  estimator_error = np.sqrt(variance / self.quantum_instance.run_config.shots)


22.066488650000004
{   'aux_operator_eigenvalues': None,
    'cost_function_evals': 50,
    'eigenstate': {   '000000101': 0.015625,
                      '000000110': 0.029231698334171417,
                      '000000111': 0.011048543456039806,
                      '000010000': 0.011048543456039806,
                      '000010101': 0.011048543456039806,
                      '000010110': 0.019136638615493577,
                      '000110110': 0.011048543456039806,
                      '000111000': 0.011048543456039806,
                      '000111001': 0.011048543456039806,
                      '001000000': 0.038273277230987154,
                      '001000001': 0.06810779599282303,
                      '001000010': 0.06346905003621844,
                      '001000011': 0.015625,
                      '001000101': 0.15934435979977452,
                      '001000110': 0.2910615001593306,
                      '001000111': 0.05182226234930312,
                      '001001000': 0.036643873123620545,
                      '001001001': 0.0924387466109315,
                      '001001010': 0.07328774624724109,
                      '001001100': 0.011048543456039806,
                      '001001101': 0.03125,
                      '001001110': 0.059498227389561786,
                      '001010000': 0.019136638615493577,
                      '001010001': 0.029231698334171417,
                      '001010010': 0.02209708691207961,
                      '001010011': 0.011048543456039806,
                      '001010100': 0.011048543456039806,
                      '001010101': 0.09568319307746789,
                      '001010110': 0.16275520824999734,
                      '001010111': 0.03983608994994363,
                      '001011001': 0.02209708691207961,
                      '001011010': 0.011048543456039806,
                      '001011100': 0.011048543456039806,
                      '001011101': 0.036643873123620545,
                      '001011110': 0.05740991584648074,
                      '001100001': 0.03125,
                      '001100010': 0.019136638615493577,
                      '001100101': 0.03314563036811941,
                      '001100110': 0.07328774624724109,
                      '001100111': 0.015625,
                      '001101000': 0.06987712429686843,
                      '001101001': 0.13975424859373686,
                      '001101010': 0.10597390598633231,
                      '001101011': 0.036643873123620545,
                      '001101101': 0.034938562148434216,
                      '001101110': 0.06899813176818631,
                      '001110000': 0.05633673867912483,
                      '001110001': 0.11587810136086973,
                      '001110010': 0.0897587913521567,
                      '001110011': 0.024705294220065465,
                      '001110101': 0.11744762795603834,
                      '001110110': 0.22371595411369302,
                      '001110111': 0.0427908248050911,
                      '001111000': 0.12153397801643785,
                      '001111001': 0.2602864257649638,
                      '001111010': 0.21079277442550065,
                      '001111011': 0.03983608994994363,
                      '001111101': 0.015625,
                      '001111110': 0.027063293868263706,
                      '010000001': 0.015625,
                      '010000010': 0.015625,
                      '010000101': 0.029231698334171417,
                      '010000110': 0.046875,
                      '010000111': 0.011048543456039806,
                      '010001000': 0.011048543456039806,
                      '010001001': 0.02209708691207961,
                      '010001010': 0.019136638615493577,
                      '010001110': 0.011048543456039806,
                      '010001111': 0.011048543456039806,
                      '010010001': 0.011048543456039806,
                      '010010101': 0.02209708691207961,
                      '010010110': 0.029231698334171417,
                      '010010111': 0.011048543456039806,
                      '010011110': 0.011048543456039806,
                      '010100101': 0.015625,
                      '010100110': 0.02209708691207961,
                      '010101000': 0.011048543456039806,
                      '010101001': 0.029231698334171417,
                      '010101010': 0.02209708691207961,
                      '010101101': 0.011048543456039806,
                      '010101110': 0.019136638615493577,
                      '010110000': 0.015625,
                      '010110001': 0.02209708691207961,
                      '010110010': 0.015625,
                      '010110101': 0.02209708691207961,
                      '010110110': 0.034938562148434216,
                      '010111000': 0.027063293868263706,
                      '010111001': 0.05633673867912483,
                      '010111010': 0.05063078670631141,
                      '010111011': 0.011048543456039806,
                      '011000101': 0.011048543456039806,
                      '011000110': 0.015625,
                      '011001010': 0.011048543456039806,
                      '011101010': 0.011048543456039806,
                      '011110110': 0.011048543456039806,
                      '011111001': 0.02209708691207961,
                      '011111010': 0.02209708691207961,
                      '100000001': 0.019136638615493577,
                      '100000100': 0.011048543456039806,
                      '100000101': 0.015625,
                      '100000110': 0.029231698334171417,
                      '100010010': 0.011048543456039806,
                      '100010101': 0.011048543456039806,
                      '100010110': 0.029231698334171417,
                      '100110010': 0.011048543456039806,
                      '100110110': 0.011048543456039806,
                      '100111001': 0.015625,
                      '100111010': 0.015625,
                      '101000000': 0.04555431167847891,
                      '101000001': 0.08193819126329309,
                      '101000010': 0.061515686515717274,
                      '101000011': 0.02209708691207961,
                      '101000100': 0.015625,
                      '101000101': 0.16350351200356522,
                      '101000110': 0.31483502624390447,
                      '101000111': 0.04941058844013093,
                      '101001000': 0.034938562148434216,
                      '101001001': 0.09043622580304864,
                      '101001010': 0.08118988160479113,
                      '101001011': 0.024705294220065465,
                      '101001101': 0.02209708691207961,
                      '101001110': 0.06051536478449089,
                      '101001111': 0.019136638615493577,
                      '101010000': 0.02209708691207961,
                      '101010001': 0.015625,
                      '101010010': 0.02209708691207961,
                      '101010101': 0.0897587913521567,
                      '101010110': 0.16275520824999734,
                      '101010111': 0.024705294220065465,
                      '101011010': 0.015625,
                      '101011100': 0.011048543456039806,
                      '101011101': 0.019136638615493577,
                      '101011110': 0.05412658773652741,
                      '101011111': 0.019136638615493577,
                      '101100000': 0.011048543456039806,
                      '101100001': 0.027063293868263706,
                      '101100010': 0.015625,
                      '101100101': 0.03314563036811941,
                      '101100110': 0.06810779599282303,
                      '101100111': 0.011048543456039806,
                      '101101000': 0.06346905003621844,
                      '101101001': 0.12597277731716483,
                      '101101010': 0.10825317547305482,
                      '101101011': 0.036643873123620545,
                      '101101101': 0.05063078670631141,
                      '101101110': 0.07574499777213015,
                      '101101111': 0.015625,
                      '101110000': 0.059498227389561786,
                      '101110001': 0.12052537984798056,
                      '101110010': 0.09631896879639025,
                      '101110011': 0.02209708691207961,
                      '101110101': 0.1269381000724369,
                      '101110110': 0.23593232610221093,
                      '101110111': 0.034938562148434216,
                      '101111000': 0.12979099785809492,
                      '101111001': 0.2679129406169101,
                      '101111010': 0.22803936748947537,
                      '101111011': 0.048159484398195125,
                      '101111100': 0.011048543456039806,
                      '101111101': 0.011048543456039806,
                      '101111110': 0.034938562148434216,
                      '110000010': 0.019136638615493577,
                      '110000101': 0.03125,
                      '110000110': 0.05846339666834283,
                      '110000111': 0.011048543456039806,
                      '110001001': 0.019136638615493577,
                      '110001010': 0.011048543456039806,
                      '110001110': 0.015625,
                      '110010001': 0.011048543456039806,
                      '110010101': 0.011048543456039806,
                      '110010110': 0.038273277230987154,
                      '110100010': 0.011048543456039806,
                      '110100011': 0.011048543456039806,
                      '110100100': 0.011048543456039806,
                      '110101000': 0.02209708691207961,
                      '110101001': 0.03125,
                      '110101010': 0.011048543456039806,
                      '110101110': 0.015625,
                      '110110001': 0.011048543456039806,
                      '110110010': 0.015625,
                      '110110101': 0.03125,
                      '110110110': 0.0427908248050911,
                      '110110111': 0.011048543456039806,
                      '110111000': 0.019136638615493577,
                      '110111001': 0.05633673867912483,
                      '110111010': 0.03983608994994363,
                      '110111110': 0.011048543456039806,
                      '111010110': 0.011048543456039806},
    'eigenvalue': (-1.3961062011717185+0j),
    'optimal_circuit': None,
    'optimal_parameters': {   ParameterVectorElement(θ[3]): 0.9692262567242826,
                              ParameterVectorElement(θ[4]): 1.2642867883228641,
                              ParameterVectorElement(θ[14]): 0.8463792877027871,
                              ParameterVectorElement(θ[16]): -0.014459268936528602,
                              ParameterVectorElement(θ[12]): 2.18024157641206,
                              ParameterVectorElement(θ[17]): -1.6753431921616952,
                              ParameterVectorElement(θ[15]): 3.2569738080876025,
                              ParameterVectorElement(θ[13]): 2.7683897737290772,
                              ParameterVectorElement(θ[0]): 1.2838423033219764,
                              ParameterVectorElement(θ[5]): 3.2075406912327287,
                              ParameterVectorElement(θ[7]): -3.0610226240215836,
                              ParameterVectorElement(θ[9]): -0.5499117056945564,
                              ParameterVectorElement(θ[6]): 2.758502107235997,
                              ParameterVectorElement(θ[11]): 1.6613895556624305,
                              ParameterVectorElement(θ[10]): 0.783563408369476,
                              ParameterVectorElement(θ[8]): 3.062947537861036,
                              ParameterVectorElement(θ[1]): 2.5249570586597203,
                              ParameterVectorElement(θ[2]): -2.0271296314251086},
    'optimal_point': array([ 1.2838423 ,  2.52495706, -2.02712963,  0.96922626,  1.26428679,
        3.20754069,  2.75850211, -3.06102262,  3.06294754, -0.54991171,
        0.78356341,  1.66138956,  2.18024158,  2.76838977,  0.84637929,
        3.25697381, -0.01445927, -1.67534319]),
    'optimal_value': -1.3961062011717185,
    'optimizer_evals': None,
    'optimizer_result': None,
    'optimizer_time': 22.18771505355835}
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Conformation Energy"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"VQE Iterations"</span><span class="p">)</span>

<span class="n">fig</span><span class="p">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="mi">40</span><span class="p">:],</span> <span class="n">values</span><span class="p">[</span><span class="mi">40</span><span class="p">:])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Conformation Energy"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"VQE Iterations"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-src="/assets/notebooks/2022-11-17-Quantum-Drug-Discovery_files/2022-11-17-Quantum-Drug-Discovery_32_0.png" alt="Jupyter Notebook Plot" data-proofer-ignore></p><h3 id="visualizing-the-answer"><span class="mr-2">Visualizing the answer</span><a href="#visualizing-the-answer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In order to reduce computational costs, we have reduced the problem’s qubit operator to the minimum amount of qubits needed to represent the shape of the protein. In order to decode the answer we need to understand how this has been done.</p><ul><li>The shape of the protein has been encoded by a sequence of turns , ${0,1,2,3}$. Each turn represents a different direction in the lattice.<li>For a main bead of $N_{aminoacids}$ in a lattice, we need $N_{aminoacids}-1$ turns in order to represent its shape. However, the orientation of the protein is not relevant to its energy. Therefore the first two turns of the shape can be set to $[1,0]$ without loss of generality.<li>If the second bead does not have any side chain, we can also set the $6^{th}$ qubit to $[1]$ without breaking symmetry.<li>Since the length of the secondary chains is always limited to $1$ we only need one turn to describe the shape of the chain.</ul><p>The total amount of qubits we need to represent the shape of the protein will be $2(N_{aminoacids}-3)$ if there is a secondary chain coming out of the second bead or $2(N_{aminoacids}-3) - 1$, otherwise. All the other qubits will remain unused during the optimization process. See:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">result</span> <span class="o">=</span> <span class="n">protein_folding_problem</span><span class="p">.</span><span class="n">interpret</span><span class="p">(</span><span class="n">raw_result</span><span class="o">=</span><span class="n">raw_result</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span>
    <span class="s">"The bitstring representing the shape of the protein during optimization is: "</span><span class="p">,</span>
    <span class="n">result</span><span class="p">.</span><span class="n">turn_sequence</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The expanded expression is:"</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">get_result_binary_vector</span><span class="p">())</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>The bitstring representing the shape of the protein during optimization is:  101000110
The expanded expression is: 1______0_____________________________________________________________________________________________________________________________100011_0____
</pre></table></code></div></div><p>Now that we know which qubits encode which information, we can decode the bitstring into the explicit turns that form the shape of the protein.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s">"The folded protein's main sequence of turns is: </span><span class="si">{</span><span class="n">result</span><span class="p">.</span><span class="n">protein_shape_decoder</span><span class="p">.</span><span class="n">main_turns</span><span class="si">}</span><span class="s">"</span>
<span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"and the side turn sequences are: </span><span class="si">{</span><span class="n">result</span><span class="p">.</span><span class="n">protein_shape_decoder</span><span class="p">.</span><span class="n">side_turns</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>The folded protein's main sequence of turns is: [1, 0, 1, 3, 0, 1]
and the side turn sequences are: [None, None, None, None, None, None, None]
</pre></table></code></div></div><p>From this sequence of turns we can get the cartesian coordinates of each of the aminoacids of the protein.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">protein_shape_file_gen</span><span class="p">.</span><span class="n">get_xyz_data</span><span class="p">())</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>[['A' '0.0' '0.0' '0.0']
 ['P' '0.5773502691896258' '0.5773502691896258' '-0.5773502691896258']
 ['R' '1.1547005383792517' '0.0' '-1.1547005383792517']
 ['L' '1.7320508075688776' '0.5773502691896258' '-1.7320508075688776']
 ['R' '1.154700538379252' '1.1547005383792517' '-2.3094010767585034']
 ['F' '0.5773502691896261' '1.7320508075688776' '-1.7320508075688776']
 ['Y' '2.220446049250313e-16' '1.154700538379252' '-1.154700538379252']]
</pre></table></code></div></div><p>And finally, we can also plot the structure of the protein in 3D. Note that when rendered with the proper backend this plot can be interactively rotated.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Protein Structure"</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">get_axes</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="n">view_init</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-src="/assets/notebooks/2022-11-17-Quantum-Drug-Discovery_files/2022-11-17-Quantum-Drug-Discovery_41_0.png" alt="Jupyter Notebook Plot" data-proofer-ignore></p><p>And here is an example with side chains.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">peptide</span> <span class="o">=</span> <span class="n">Peptide</span><span class="p">(</span><span class="s">"APRLR"</span><span class="p">,</span> <span class="p">[</span><span class="s">""</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="s">"F"</span><span class="p">,</span> <span class="s">"Y"</span><span class="p">,</span> <span class="s">""</span><span class="p">])</span>
<span class="n">protein_folding_problem</span> <span class="o">=</span> <span class="n">ProteinFoldingProblem</span><span class="p">(</span><span class="n">peptide</span><span class="p">,</span> <span class="n">mj_interaction</span><span class="p">,</span> <span class="n">penalty_terms</span><span class="p">)</span>
<span class="n">qubit_op</span> <span class="o">=</span> <span class="n">protein_folding_problem</span><span class="p">.</span><span class="n">qubit_op</span><span class="p">()</span>
<span class="n">raw_result</span> <span class="o">=</span> <span class="n">vqe</span><span class="p">.</span><span class="n">compute_minimum_eigenvalue</span><span class="p">(</span><span class="n">qubit_op</span><span class="p">)</span>
<span class="n">result_2</span> <span class="o">=</span> <span class="n">protein_folding_problem</span><span class="p">.</span><span class="n">interpret</span><span class="p">(</span><span class="n">raw_result</span><span class="o">=</span><span class="n">raw_result</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">result_2</span><span class="p">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Protein Structure"</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">get_axes</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="n">view_init</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-src="/assets/notebooks/2022-11-17-Quantum-Drug-Discovery_files/2022-11-17-Quantum-Drug-Discovery_44_0.png" alt="Jupyter Notebook Plot" data-proofer-ignore></p><h3 id="references"><span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><font size="2">[1] https://en.wikipedia.org/wiki/Levinthal%27s_paradox </font> <font size="2">[2] A.Robert, P.Barkoutsos, S.Woerner and I.Tavernelli, Resource-efficient quantum algorithm for protein folding, NPJ Quantum Information, 2021, https://doi.org/10.1038/s41534-021-00368-4 </font> <font size="2">[3] IUPAC–IUB Commission on Biochemical Nomenclature (1972). "A one-letter notation for aminoacid sequences". Pure and Applied Chemistry. 31 (4): 641–645. doi:10.1351/pac197231040639. PMID 5080161.</font><p><br /></p><font size="2">[4] https://en.wikipedia.org/wiki/Amino_acid</font> <font size="2"> [5] S. Miyazawa and R. L.Jernigan, Residue – Residue Potentials with a Favorable Contact Pair Term and an Unfavorable High Packing Density Term for Simulation and Threading, J. Mol. Biol.256, 623–644, 1996, Table 3, https://doi.org/10.1006/jmbi.1996.0114 </font> <font size="2"> [6] P.Barkoutsos, G. Nannichini, A.Robert, I.Tavernelli, S.Woerner, Improving Variational Quantum Optimization using CVaR, Quantum 4, 256, 2020, https://doi.org/10.22331/q-2020-04-20-256 </font> <font size="2"> [7] S.Suwanna, Key Obstacles for Quantum Supremacy, https://www.nectec.or.th/ace2019/wp-content/uploads/2019/09/20190909_SS09_Dr.Sujin_.pdf </font> <font size="2"> [8] F. Pan, simulating the sycamore quantum supremacy circuit, https://www.nectec.or.th/ace2019/wp-content/uploads/2019/09/20190909_SS09_Dr.Sujin_.pdf </font> <font size="2"> [9] L.J. O'Riordan, Lightning-fast simulations with PennyLane and the NVIDIA cuQuantum SDK, https://pennylane.ai/blog/2022/07/lightning-fast-simulations-with-pennylane-and-the-nvidia-cuquantum-sdk/ </font> <font size="2"> [10] IBM, Qiskit Textbook(beta), https://qiskit.org/learn/ </font> <font size="2"> [11] IBM, Qiskit Research , https://github.com/qiskit-research/qiskit-research </font><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">qiskit.tools.jupyter</span>

<span class="o">%</span><span class="n">qiskit_version_table</span>
<span class="o">%</span><span class="n">qiskit_copyright</span>
</pre></table></code></div></div><h3>Version Information</h3><div class="table-wrapper"><table><tr><th>Qiskit Software<th>Version<tr><td><code>qiskit-terra</code><td>0.22.2<tr><td><code>qiskit-aer</code><td>0.12.0<tr><td><code>qiskit-ibmq-provider</code><td>0.19.2<tr><td><code>qiskit</code><td>0.39.2<tr><td><code>qiskit-nature</code><td>0.4.2<tr><td><code>qiskit-optimization</code><td>0.4.0<tr><th>System information<tr><td>Python version<td>3.10.6<tr><td>Python compiler<td>GCC 11.2.0<tr><td>Python build<td>main, Oct 24 2022 16:07:47<tr><td>OS<td>Linux<tr><td>CPUs<td>128<tr><td>Memory (Gb)<td>2015.6843872070312<tr><td colspan="2">Thu Nov 17 07:19:27 2022 +07</table></div><div style="width: 100%; background-color:#d5d9e0;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px"><h3>This code is a part of Qiskit</h3><p>&copy; Copyright IBM 2017, 2022.</p><p>This code is licensed under the Apache License, Version 2.0. You may<br />obtain a copy of this license in the LICENSE.txt file in the root directory<br /> of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.<p>Any modifications or derivative works of this code must retain this<br />copyright notice, and modified files need to carry a notice indicating<br />that they have been altered from the originals.</p>&lt;/div&gt; ```python ```</p></div></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Quantum+Drug+Discovery+-+Extreme+Tools+for+Science+and+Engineering+Discovery&url=https%3A%2F%2Fsnitgit.github.io%2Fposts%2FQuantum-Drug-Discovery%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Quantum+Drug+Discovery+-+Extreme+Tools+for+Science+and+Engineering+Discovery&u=https%3A%2F%2Fsnitgit.github.io%2Fposts%2FQuantum-Drug-Discovery%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fsnitgit.github.io%2Fposts%2FQuantum-Drug-Discovery%2F&text=Quantum+Drug+Discovery+-+Extreme+Tools+for+Science+and+Engineering+Discovery" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tensor_network_in_Quantum_Information_Science_Engineering_Physics/">Tensor_network_in_quantum_information_science_engineering_physics</a><li><a href="/posts/Quantum-Drug-Discovery/">Quantum Drug Discovery</a><li><a href="/posts/CPU_RISC_V_Layout_multi_university_wafer/">Cpu_risc_v_layout_multi_university_wafer</a><li><a href="/posts/Reproducible-slurm-notebook/"> Reproducible Slurm Notebook</a><li><a href="/posts/Quantum-Exspesso/">Quantum ESPRESSO on exascale.mahidol.ac.th Multi-Node-Multi-GPUs MNMG Testing</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Tensor_network_in_Quantum_Information_Science_Engineering_Physics/"><div class="card-body"> <em class="small" data-ts="1669741200" data-df="ll" > Nov 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tensor_network_in_quantum_information_science_engineering_physics</h3><div class="text-muted small"><p> Unify Quantum Information Science and Quantum Machine Learning with Quantum Tensor Networks as modern diagrammatic reasoning on GPUs Cluster Boring and waiting for NVIDIA cuQuantum appliance for m...</p></div></div></a></div><div class="card"> <a href="/posts/CPU_RISC_V_Layout_multi_university_wafer/"><div class="card-body"> <em class="small" data-ts="1665680400" data-df="ll" > Oct 14, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cpu_risc_v_layout_multi_university_wafer</h3><div class="text-muted small"><p> Chip RISC V CPU: Physical tape out in a Jupyter notebook on ExamScale Cluster Motivated by difficulty experiences in IC Design about 18 and 8 years ago, this note will save time and resource for ...</p></div></div></a></div><div class="card"> <a href="/posts/Analog-IC-Layout/"><div class="card-body"> <em class="small" data-ts="1665334800" data-df="ll" > Oct 10, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Analog Ic Layout</h3><div class="text-muted small"><p> Python: Analog Inverter Chip Layout with Magic and PySpice Simulation on Sky 130nm PDK This notebook demo how to create inverter loayout and extract analog net-list to simulate with Sky 130 nm PDK...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CPU_RISC_V_Layout_multi_university_wafer/" class="btn btn-outline-primary" prompt="Older"><p>Cpu_risc_v_layout_multi_university_wafer</p></a> <a href="/posts/Tensor_network_in_Quantum_Information_Science_Engineering_Physics/" class="btn btn-outline-primary" prompt="Newer"><p>Tensor_network_in_quantum_information_science_engineering_physics</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">SNIT SANGHLAO</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
